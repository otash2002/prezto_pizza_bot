<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Presto Pizza</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { 
            --main: #ffcc00; 
            --bg: #000; 
            --card: #fff; 
            --text: #000;
        }
        body { 
            font-family: 'Segoe UI', -apple-system, sans-serif; 
            background: var(--bg); 
            color: white; 
            padding: 0 12px 140px 12px;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }
        .header {
            position: sticky;
            top: 0;
            background: var(--bg);
            padding: 15px 0;
            z-index: 100;
            border-bottom: 2px solid var(--main);
            margin-bottom: 20px;
        }
        .header h1 {
            color: var(--main);
            font-size: 24px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .category-title { 
            color: var(--main); 
            margin: 25px 0 15px; 
            border-left: 4px solid var(--main); 
            padding-left: 12px; 
            text-transform: uppercase; 
            font-weight: bold; 
            font-size: 18px;
        }
        .grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 12px; 
            margin-bottom: 20px;
        }
        .card { 
            background: var(--card); 
            border-radius: 16px; 
            padding: 12px; 
            color: var(--text); 
            display: flex; 
            flex-direction: column; 
            justify-content: space-between; 
            min-height: 170px;
            box-shadow: 0 4px 15px rgba(255, 204, 0, 0.2);
            transition: transform 0.1s;
        }
        .card:active { transform: scale(0.97); }
        .product-img { font-size: 45px; text-align: right; line-height: 1; margin-bottom: 8px; }
        .product-name { font-weight: 700; font-size: 15px; margin: 8px 0; min-height: 38px; display: flex; align-items: center; line-height: 1.3; }
        .product-price { color: #d35400; font-weight: bold; font-size: 14px; margin-bottom: 12px; }
        .controls { 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            background: #f5f5f5; 
            border-radius: 12px; 
            padding: 6px;
        }
        .btn { 
            border: none; 
            width: 35px; 
            height: 35px; 
            border-radius: 10px; 
            font-size: 24px; 
            cursor: pointer; 
            background: var(--main); 
            color: #000;
            font-weight: bold; 
            display: flex; 
            align-items: center; 
            justify-content: center;
        }
        .count { font-weight: bold; font-size: 18px; min-width: 30px; text-align: center; color: var(--text); }
        .loading { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--main); font-size: 18px; }
        .has-items { border: 2px solid var(--main); }
    </style>
</head>
<body>
    <div class="header">
        <h1>üçï Presto Pizza</h1>
    </div>
    
    <div id="menu-list">
        <div class="loading">‚è≥ Yuklanmoqda...</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.setParams({ color: '#ffcc00', text_color: '#000000' });

        let cart = {};

        const menuData = {
            "PIZZA": [
                {id: "p1", name: "Pepperoni", price: 70000, img: "üçï"},
                {id: "p2", name: "Pollo", price: 75000, img: "üçï"},
                {id: "p3", name: "Vetchina", price: 75000, img: "üçï"},
                {id: "p4", name: "Carnoso", price: 85000, img: "üçï"},
                {id: "p5", name: "4 Type", price: 90000, img: "üçï"},
                {id: "p6", name: "Presto Pizza", price: 100000, img: "üçï"}
            ],
            "HOT-DOG": [
                {id: "h1", name: "Oddiy Hot-dog", price: 10000, img: "üå≠"},
                {id: "h2", name: "Canada", price: 13000, img: "üå≠"},
                {id: "h3", name: "Canada 2x", price: 15000, img: "üå≠"},
                {id: "h4", name: "Chicken Hot-dog", price: 18000, img: "üå≠"},
                {id: "h5", name: "Go'shtli Hot-dog", price: 20000, img: "üå≠"},
                {id: "h6", name: "Qazili Hot-dog", price: 25000, img: "üå≠"}
            ],
            "SANDWICH": [
                {id: "s1", name: "Indeyka", price: 30000, img: "ü•™"},
                {id: "s2", name: "Carnoso", price: 35000, img: "ü•™"},
                {id: "s3", name: "Pollo", price: 30000, img: "ü•™"}
            ],
            "BURGER": [
                {id: "b1", name: "Burger Oddiy", price: 15000, img: "üçî"},
                {id: "b2", name: "Chizburger", price: 17000, img: "üçî"},
                {id: "b3", name: "Chicken Burger", price: 20000, img: "üçî"},
                {id: "b4", name: "BBQ Burger", price: 25000, img: "üçî"}
            ],
            "DONER": [
                {id: "d1", name: "Doner", price: 25000, img: "ü•ô"},
                {id: "d2", name: "Non Kabob", price: 35000, img: "ü•ô"},
                {id: "d3", name: "KFC 1 porsiya", price: 25000, img: "üçó"},
                {id: "d4", name: "Free", price: 15000, img: "üçü"}
            ]
        };

        function render() {
            const list = document.getElementById('menu-list');
            list.innerHTML = '';
            
            for (let cat in menuData) {
                const title = document.createElement('div');
                title.className = 'category-title';
                title.textContent = cat;
                list.appendChild(title);

                const grid = document.createElement('div');
                grid.className = 'grid';

                menuData[cat].forEach(p => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.id = `card-${p.id}`;
                    card.innerHTML = `
                        <div class="product-img">${p.img}</div>
                        <div class="product-name">${p.name}</div>
                        <div class="product-price">${p.price.toLocaleString()} UZS</div>
                        <div class="controls">
                            <button class="btn" onclick="updateCount('${p.id}', '${p.name}', ${p.price}, -1)">-</button>
                            <span class="count" id="q-${p.id}">0</span>
                            <button class="btn" onclick="updateCount('${p.id}', '${p.name}', ${p.price}, 1)">+</button>
                        </div>
                    `;
                    grid.appendChild(card);
                });
                list.appendChild(grid);
            }
        }

        function updateCount(id, name, price, delta) {
            if (!cart[id]) cart[id] = { name, price, quantity: 0 };
            
            cart[id].quantity += delta;
            if (cart[id].quantity < 0) cart[id].quantity = 0;

            document.getElementById(`q-${id}`).innerText = cart[id].quantity;
            
            const card = document.getElementById(`card-${id}`);
            if (cart[id].quantity > 0) card.classList.add('has-items');
            else card.classList.remove('has-items');

            calculateTotal();
        }

        function calculateTotal() {
            let total = 0;
            let items = 0;
            for (let key in cart) {
                total += cart[key].price * cart[key].quantity;
                items += cart[key].quantity;
            }

            if (total > 0) {
                tg.MainButton.setText(`BUYURTMA BERISH: ${total.toLocaleString()} UZS (${items} ta)`);
                tg.MainButton.show();
            } else {
                tg.MainButton.hide();
            }
        }

        tg.onEvent('mainButtonClicked', () => {
            const order = Object.values(cart).filter(i => i.quantity > 0);
            tg.showConfirm("Buyurtmani tasdiqlaysizmi?", (confirm) => {
                if(confirm) {
                    tg.sendData(JSON.stringify(order));
                }
            });
        });

        window.onload = () => {
            render();
            tg.ready();
        };
    </script>
</body>
</html>