<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presto Pizza</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --main-color: #ffcc00; --bg-dark: #000000; --card-bg: #ffffff; }
        body { font-family: 'Segoe UI', Roboto, sans-serif; background: var(--bg-dark); color: white; margin: 0; padding-bottom: 100px; }
        
        /* Banner qismi */
        .banner { width: 100%; height: 250px; background: url('https://images.unsplash.com/photo-1513104890138-7c749659a591?w=800') center/cover; position: relative; }
        .banner-title { position: absolute; bottom: 0; left: 0; right: 0; padding: 20px; background: linear-gradient(transparent, black); text-align: center; font-size: 24px; font-weight: bold; }

        .container { padding: 12px; }
        .category-title { font-size: 18px; font-weight: bold; color: var(--main-color); margin: 20px 0 10px; border-left: 4px solid var(--main-color); padding-left: 10px; text-transform: uppercase; }

        /* Mahsulotlar to'ri (2 tadan) */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .card { background: var(--card-bg); border-radius: 15px; padding: 10px; color: #333; display: flex; flex-direction: column; justify-content: space-between; position: relative; }
        
        .product-img { width: 100%; height: 80px; object-fit: contain; margin-bottom: 5px; border-radius: 10px; }
        .product-name { font-size: 14px; font-weight: bold; margin: 5px 0; height: 35px; overflow: hidden; color: #000; }
        .product-price { color: #555; font-size: 13px; font-weight: bold; margin-bottom: 10px; }

        /* Boshqaruv tugmalari */
        .controls { display: flex; align-items: center; justify-content: space-between; background: #f0f0f0; border-radius: 8px; padding: 3px; }
        .btn { border: none; width: 28px; height: 28px; border-radius: 6px; font-size: 18px; font-weight: bold; cursor: pointer; }
        .plus { background: #333; color: var(--main-color); }
        .minus { background: #ddd; color: #333; }
        .count { font-weight: bold; font-size: 14px; color: #000; }
    </style>
</head>
<body>
    <div class="banner">
        <div class="banner-title">PRESTO PIZZA</div>
    </div>

    <div class="container" id="menu-content">
        </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.setParams({ color: '#ffcc00', text_color: '#000000' });

        // Siz yuborgan rasmdagi barcha menyu va narxlar
        const menuData = {
            "Pizza": [
                {id: "p1", name: "Pepperoni", price: 70000, img: "üçï"},
                {id: "p2", name: "Pollo", price: 75000, img: "üçï"},
                {id: "p3", name: "Vetchina", price: 75000, img: "üçï"},
                {id: "p6", name: "Presto Pizza", price: 100000, img: "üçï"}
            ],
            "Sandwich": [
                {id: "s1", name: "Indeyka", price: 30000, img: "ü•™"},
                {id: "s2", name: "Carnoso", price: 35000, img: "ü•™"}
            ],
            "Burger": [
                {id: "b1", name: "Burger Oddiy", price: 15000, img: "üçî"},
                {id: "b2", name: "Chizburger", price: 17000, img: "üçî"}
            ],
            "Hot-Dog": [
                {id: "h1", name: "Hot-Dog Oddiy", price: 10000, img: "üå≠"},
                {id: "h2", name: "Canada", price: 13000, img: "üå≠"}
            ],
            "Lavash": [
                {id: "l1", name: "Lavash", price: 25000, img: "üåØ"},
                {id: "l3", name: "Tandir Lavash", price: 30000, img: "üåØ"}
            ]
        };

        let cart = {};
        const container = document.getElementById('menu-content');

        for (let cat in menuData) {
            let html = `<div class="category-title">${cat}</div><div class="grid">`;
            menuData[cat].forEach(p => {
                html += `
                <div class="card">
                    <div style="font-size: 40px; text-align: center;">${p.img}</div>
                    <div class="product-name">${p.name}</div>
                    <div class="product-price">${p.price.toLocaleString()} UZS</div>
                    <div class="controls">
                        <button class="btn minus" onclick="update('${p.id}', '${p.name}', ${p.price}, -1)">-</button>
                        <span class="count" id="q-${p.id}">0</span>
                        <button class="btn plus" onclick="update('${p.id}', '${p.name}', ${p.price}, 1)">+</button>
                    </div>
                </div>`;
            });
            html += `</div>`;
            container.innerHTML += html;
        }

        function update(id, name, price, delta) {
            if (!cart[id]) cart[id] = { name, price, count: 0 };
            cart[id].count += delta;
            if (cart[id].count < 0) cart[id].count = 0;
            
            document.getElementById(`q-${id}`).innerText = cart[id].count;
            
            let total = 0;
            for (let key in cart) total += cart[key].count * cart[key].price;

            if (total > 0) {
                tg.MainButton.setText(`BUYURTMA BERISH: ${total.toLocaleString()} UZS`);
                tg.MainButton.show();
            } else {
                tg.MainButton.hide();
            }
        }

        tg.onEvent('mainButtonClicked', function() {
            let order = [];
            for (let key in cart) {
                if (cart[key].count > 0) {
                    for(let i=0; i<cart[key].count; i++) order.push({ name: cart[key].name, price: cart[key].price });
                }
            }
            tg.sendData(JSON.stringify(order));
        });
    </script>
</body>
</html>